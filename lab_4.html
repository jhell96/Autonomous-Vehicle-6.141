<!DOCTYPE html>
<html lang="en">
  <head>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="This is the portfolio for MIT class 6.141 team-8">

    <title>Team 8 Speed Racer</title>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="materialize/css/materialize.min.css"  media="screen,projection"/>
    <link type="text/css" rel="stylesheet" href="stylesheets/team8.css"  media="screen,projection"/>
    <link type="text/css" rel="stylesheet" href="stylesheets/markdown.css"  media="screen,projection"/>

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  </head>

  <body>
    <header>
      <nav class="top-nav" id="top-nav-bar">
        <div class="container">
          <div class="nav-wrapper">
            <a href="#" data-activates="nav-mobile" class="left button-collapse top-nav waves-effect waves-light circle hide-on-large-only">
              <i class="material-icons">menu</i>
            </a>
            <a class="page-title"></a>
          </div>
        </div>
      </nav>
      <ul id="nav-mobile" class="side-nav fixed">
        <li class="logo">
          <a id="logo-container" href="index.html" class="brand-logo center">
            <img id="front-page-logo" class="responsive-img" src="images/logo.jpg" />
          </a>
        </li>
        <li><div class="divider"></div></li>
        <li class="bold"><a href="index.html" class="waves-effect waves-red">Home</a></li>
        <li class="bold"><a href="about.html" class="waves-effect waves-red">About</a></li>
        <li class="bold"><a href="bios.html" class="waves-effect waves-red">Bios</a></li>
        <li class="no-padding">
          <ul class="collapsible collapsible-accordion">
            <li class="bold">
              <a class="collapsible-header waves-effect waves-red collapsible-header-mod">Lab Reports</a>
              <div class="collapsible-body collapsible-body-mod">
                <ul>
                  <li><a href="lab_2.html">Lab 2</a></li>
                  <li><a href="lab_3.html">Lab 3</a></li>
                  <li><a href="lab_4.html">Lab 4</a></li>
                  <li><a href="lab_5.html">Lab 5</a></li>
                  <li><a href="lab_6.html">Lab 6</a></li>
                  <li><a href="lab_7.html">Lab 7</a></li>
                </ul>
              </div>
            </li>
          </ul>
        </li>
        <li class="bold"><a href="gallery.html" class="waves-effect waves-red">Gallery</a></li>
      </ul>
    </header>


    <main>
      <div class="container" id="main-container">
        <div class="row">
          <div class="col s12 m12 l12">
              <div id="doc" class="markdown-body container-fluid"><h1 id="lab-4-visual-servoing"><a class="anchor hidden-xs" href="#lab-4-visual-servoing" title="lab-4-visual-servoing"><span class="octicon octicon-link"></span></a>Lab 4: Visual Servoing</h1><a href="static/rss-team8-lab4.pdf">Download as a PDF</a><br><br><p>Lab 4 is a two-week and two-part lab regarding visual servoing. During Part A of the lab, teams were asked to explore various computer vision object-tracking algorithms (such as SIFT, template matching, or color threshold blob detection) to track a small orange cone. The robot can find a cone in its view and then park itself a set distance in front of the cone, as well as maintain a set distance from the cone as it moves. In Part B of the lab, our group implemented line following algorithms to drive around a circle. We compare results using open-loop control, setpoint control, and Pure Pursuit control schemes.</p><h1 id="lab-4a-cone-parking"><a class="anchor hidden-xs" href="#lab-4a-cone-parking" title="lab-4a-cone-parking"><span class="octicon octicon-link"></span></a>Lab 4A: Cone Parking</h1><p><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/150.png" alt=""></p><p>The first part of the lab asks us to park our car 1.5-2 feet from a small orange cone. The image above was captured from the onboard camera while parked 150cm from the cone. The main challenges in this task are cone detection and parking control.<br>
[Kevin]</p><h2 id="cone-detection"><a class="anchor hidden-xs" href="#cone-detection" title="cone-detection"><span class="octicon octicon-link"></span></a>Cone Detection</h2><p>The cone detection methods output a bounding box around cones in the image. These bounding boxes can be used to calculate the distance and angle to the cone.</p><h3 id="method-1-sift-and-ransac"><a class="anchor hidden-xs" href="#method-1-sift-and-ransac" title="method-1-sift-and-ransac"><span class="octicon octicon-link"></span></a><em>Method 1: SIFT and RANSAC</em></h3><p>Initially the team attempted to implement a Scale-Invariant Feature Transform (SIFT) and Random Sample Consensus (RANSAC) algorithm. This object detection method is historically quite robust and is useful for not confusing background with the intended object. This is because the algorithm is intended to find keypoints in the current input image that correspond to features in a reference image, making the method robust to scale, orientation, illumination, and viewpoint [1]. The issue that the team ran into with this method was that the cones do not really have features for the algorithm to sense as keypoints. This means that most of the keypoints found by the algorithm were in the background since the cones were featureless, and the keypoints that were on the cone were replaceable around most points on the reference cone, making the robot think that the image was rotated or did not exist in the frame. [Caroline]</p><p><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/sift_keypoints_3.jpg" alt=""></p><h3 id="method-2-hsv-blob-detection"><a class="anchor hidden-xs" href="#method-2-hsv-blob-detection" title="method-2-hsv-blob-detection"><span class="octicon octicon-link"></span></a><em>Method 2: HSV Blob Detection</em></h3><p>When SIFT didn’t work for the cone detection, we decided to try an HSV blob detector. The first step was doing a simple HSV threshold. We converted the images received from the camera into HSV space. Then using threshold values determined experimentally, we filtered the image by color, keeping only spots identified as “orange”.</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span></div><div class="code"><span class="hljs-comment"># Get the mask of an image to filter out</span>
<span class="hljs-comment"># everything but orange</span>

self.HSV_MIN = np.array([<span class="hljs-number">6</span>, <span class="hljs-number">90</span>, <span class="hljs-number">160</span>])
self.HSV_MAX = np.array([<span class="hljs-number">15</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>])

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getMask</span><span class="hljs-params">(self, hsvImage)</span>:</span>
    <span class="hljs-comment"># HSV Threshold</span>
    mask = cv2.inRange(hsvImage, self.HSV_MIN, self.HSV_MAX)
    <span class="hljs-comment"># Erode and dilate the mask to </span>
    <span class="hljs-comment"># clean up noise and reconnect points</span>
    mask = cv2.erode(mask, <span class="hljs-keyword">None</span>, iterations = <span class="hljs-number">1</span>)
    mask = cv2.dilate(mask, <span class="hljs-keyword">None</span>, iterations = <span class="hljs-number">3</span>)
    <span class="hljs-keyword">return</span> mask
</div></div></code></pre><p>This is an example of the filtered version of the above picture of a cone 150 cm away from our car.</p><p><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/150_filtered.png" alt=""></p><p>In order to filter out the noise, we employed 3 different filters: a shape matching score, aspect ratio, and area. OpenCV’s methods <code>findContours</code> and <code>boundingRect</code> gave us information about all the objects after applying the color threshold, including their widths, heights, and pixel coordinates.</p><p>To get a good idea whether one of the identified objects was a cone, we wanted to compare it to an object we knew was a cone. We resized a sample picture of the cone to the size of the new bounding box. Using OpenCV’s <code>matchShapes</code> method, the images were compared to see their similarities. The more similar the objects, the lower score was returned. An image would return a score of 0 if matched with itself.</p><p>After checking if the objects looked similar to an image of a cone, we wanted to confirm its similarity to an actual cone. By looking at a lot of different sample cone images with the cone at varying angles and distances away from the robot, we found that the aspect ratio of the cone was about 0.65. This filter helped get rid of a lot of noise that was wider than it was tall, even if the noise was slightly cone-shaped.</p><p>Finally, if there were two different objects that were both very “cone-like”, we chose the biggest one to target. This meant that if there were two cones within the camera’s field of view, our robot would only consider the closest one. Below is the code where we do the main filtering.</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span></div><div class="code"><span class="hljs-comment"># Return the best object out of all identified</span>
<span class="hljs-comment"># objects based on shape matching score, aspect</span>
<span class="hljs-comment"># ratio, and area</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">filterContours</span><span class="hljs-params">(self)</span>:</span>
    matchValues = self.templateMatching()
    self.filteredContours = []
    bestArea = <span class="hljs-number">0</span>
    self.bestWidth = <span class="hljs-keyword">None</span>

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(self.contours)):
        contour = self.contours[i]
        matchValue = matchValues[i]
        xTop, yTop, width, height = cv2.boundingRect(contour)
        aspectRatio = width/float(height)

        <span class="hljs-keyword">if</span> (matchValue &lt; self.MATCH_MAX) <span class="hljs-keyword">and</span> (self.ASPECT_MIN &lt; aspectRatio &lt; self.ASPECT_MAX):
            <span class="hljs-keyword">if</span> (self.ASPECT_MIN &lt; aspectRatio &lt; self.ASPECT_MAX):
                self.filteredContours.append(contour)
                area = width * height

                <span class="hljs-keyword">if</span> area  &gt;= bestArea:
                    bestArea = area
                    self.bestContour = contour
                    self.bestWidth = width
                    self.bestHeight = height
                    self.bestxTop = xTop
                    self.bestyTop = yTop
</div></div></code></pre><p>The figure below shows the final results of our cone processing. The bounding boxes of all thresholded objects were drawn with their shape matching scores and aspect ratios. The boxes with the red text were all filtered out, so the only object the camera considered was the large cone with the yellow text. [Katy]</p><p><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/blob_detection.png" alt=""></p><h2 id="parking-controller"><a class="anchor hidden-xs" href="#parking-controller" title="parking-controller"><span class="octicon octicon-link"></span></a>Parking Controller</h2><p>The objective for the parking controller was to:</p><ol>
<li>Have the car park 1.5ft in front of a cone from a starting distance of &gt; 6ft.</li>
<li>Have the car maintain a set distance of 1.5ft from a moving cone.</li>
</ol><p>After implementing the computer vision algorithms discussed above, we had to determine the distance and angle of the cone from its pixel coordinates/representation, in order to park the car accordingly. We collected 20 image samples measuring cone-height in pixels (from the bounding box determined using color thresholding), and real-world distance of the cone.</p><p>First, we tried to directly plot the relationship between pixel height and known, and regress a 7th degree polynomial to the relationship. This process was complex and still had less precision than wanted. The next attempt to model distance was by using the bounding box pixel height to find an intermediate real-world theta value, and then to distance. However, we soon realized this was insufficient for when the cone was at large angles to the car, due to the properties of the camera. We instead opted to determine the camera matrix, and focal length of the camera. More information on the calibration process can be found in the Camera Calibration section. From this, we could determine the real-world distance of the cone according to the Pinhole Camera Model, as the ratio of the size of the object on the sensor and the size of the object in real life is the same as the ratio between the focal length and distance to the object.</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span></div><div class="code">DIST_TIMES_FOCAL_LENGTH_PX = <span class="hljs-number">50</span>/<span class="hljs-number">0.0068</span>
<span class="hljs-keyword">return</span> self.DIST_TIMES_FOCAL_LENGTH_PX/self.getHeight()
</div></div></code></pre><p>We could also determine the angle offset of the cone from the car by determining how far the center of the bounding box of the cone was off from the image center (where the image size was normalized to 1):</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span></div><div class="code"> <span class="hljs-keyword">return</span> (self.bestxTop + <span class="hljs-number">0.5</span>*self.bestWidth)/self.imageWidth - <span class="hljs-number">.5</span>
</div></div></code></pre><p>Once we determined the distance and angle offset, we were able to create a proportional-derivative (PD) controller for steering and velocity of the car.</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span></div><div class="code">steering_angle = -theta - self.ANGLE_KD*(theta - self.last_angle)
error = np.log(angle_range.range/self.SET_RANGE)
</div></div></code></pre><p>Here, we take the log of the ratio between the actual distance and the set distance for the cone to the car, to set the error for the velocity computation. We did this because the velocity was too small when the car was close to the cone, and extremely large when far away from the cone.</p><p>[Josh]</p><h2 id="cone-parking-results"><a class="anchor hidden-xs" href="#cone-parking-results" title="cone-parking-results"><span class="octicon octicon-link"></span></a>Cone Parking Results</h2><p>Using the HSV blob detection with further filters worked really well for consistently identifying the cone and only the cone. However, the environments we were running the car in didn’t inherently have a lot of noise, so the extra processing was unnecessary. The shape matching criteria was taken out of the final implementation to help speed up the processing without any penalties on actual performance.</p><p>The nonlinear (log) factor scaling the error for velocity control made the car extremely responsive at small distance from the cone, and have a more realistic velocity far distances from the cone, which was a much favorable response to the purely linear controller.</p><p>Due to the high resolution (2k) and frame rate (60-100hz) of the Zed camera, we had to decrease the resolution to decrease latency in the pipeline. The higher resolution image took too long to process, and resulted in a 3 second delay. With the resolution decreased to VGA, our car became latency-free.</p><p>[Katy, Josh]</p><div class="video-container">
      <iframe width="100%" height="100%" src="https://drive.google.com/file/d/0B258kahpO9vlZGtYNExYc3ZabGM/preview" frameborder="0" allowfullscreen></iframe>
      <div style="width: 80px; height: 80px; position: absolute; opacity: 0; right: 0px; top: 0px;">&nbsp;</div>
    </div><br><div class="video-container">
      <iframe width="100%" height="100%" src="https://www.youtube.com/embed/ETZ1TSduvyU" frameborder="0" allowfullscreen></iframe>
    </div><h1 id="lab-4b-line-follower"><a class="anchor hidden-xs" href="#lab-4b-line-follower" title="lab-4b-line-follower"><span class="octicon octicon-link"></span></a>Lab 4B: Line Follower</h1><p>For the next part of the lab, teams were asked to extend their cone following implementations to a line follower. Three different controllers of a line follower were implemented: an open-loop controller, a setpoint controller, and a tracking controller. Though assumed that the tracking controller would have the best line-following capabilities, all three are implemented in order to compare performance. The performance metrics included the maximum stable speed and number of loops around a circle.<br>
[Caroline]</p><h2 id="open-loop-control"><a class="anchor hidden-xs" href="#open-loop-control" title="open-loop-control"><span class="octicon octicon-link"></span></a>Open Loop Control</h2><h3 id="overview"><a class="anchor hidden-xs" href="#overview" title="overview"><span class="octicon octicon-link"></span></a><em>Overview</em></h3><p>The open-loop controller only published a constant drive speed and steering angle to the car. After beginning with a slow speed of 0.1 m/s and small steering angle of less than 15 degrees, both of these parameters were changed to attempt to stay on the circular path for as long as possible. The steering angle was decreased to fit the circle with a 5’ radius marked on the floor by the course staff. The speed was slightly increased for testing.<br>
[Caroline]</p>
    <div class="video-container">
      <iframe width="100%" height="100%" src="https://drive.google.com/file/d/0B1r8mrSoCnNJUXRJYW43emZteG8/preview" frameborder="0" allowfullscreen></iframe>
      <div style="width: 80px; height: 80px; position: absolute; opacity: 0; right: 0px; top: 0px;">&nbsp;</div>
    </div><h3 id="testing"><a class="anchor hidden-xs" href="#testing" title="testing"><span class="octicon octicon-link"></span></a><em>Testing</em></h3><p>Testing of the open-loop controller involved calibrating the steering angle until it started to follow the circle for a short time. We had started at just less than 15 degrees (<code>STEER_ANGLE = 0.2 rad</code>) as an estimate. This value for steering angle still turned too much so we calibrated and eventually came to a value of <code>STEER_ANGLE = 0.13</code> that followed the circle. We increased the speed slightly but did not attempt to test very fast speeds because even with the calibrated steering angle the car diverged from the circle at after only completing about ¼ of the way around, as stated in Table 1 below.<br>
[Caroline]</p><h2 id="set-point-control"><a class="anchor hidden-xs" href="#set-point-control" title="set-point-control"><span class="octicon octicon-link"></span></a>Set Point Control</h2><h3 id="overview1"><a class="anchor hidden-xs" href="#overview1" title="overview1"><span class="octicon octicon-link"></span></a><em>Overview</em></h3><p>The setpoint controller utilizes the same HSV color blob threshold as the initial cone detector. The first change from part 4A of the lab is the the upper three-fourths of the input image are masked so that controller only samples from the bottom fourth of the image. It also did not apply the bounding box based on any geometric parameters like aspect ratio or shape matching, only based on color. This assumes that there will not be any background noise to confuse the HSV color blob thresholding. This is a good assumption since the only part of the image being processed displays only what is closest to the robot (about 10 cm to 25 cm in range).</p><p>The controller then took the location of the bounding box and calculated the horizontal error from the center point of the tracked orange tape to the center point of the Zed Camera image. This error was converted to a normalized location horizontally on the image and then into radians to be used for steering angle control. For simplicity, the controller was scaled by a proportional term but did not utilize a derivative term or an integral term.<br>
[Caroline]</p><div class="video-container">
      <iframe width="100%" height="100%" src="https://drive.google.com/file/d/0B1r8mrSoCnNJd0NTckRfWEVCcW8/preview" frameborder="0" allowfullscreen></iframe>
      <div style="width: 80px; height: 80px; position: absolute; opacity: 0; right: 0px; top: 0px;">&nbsp;</div>
    </div><h3 id="testing1"><a class="anchor hidden-xs" href="#testing1" title="testing1"><span class="octicon octicon-link"></span></a><em>Testing</em></h3><p>The setpoint controller worked quite well on the 5ft circle, and most likely could have been run at a faster speed than it was (at 0.466 m/s). It was tracking to the outside of the circle (left wheels just inside the circle), which is thought to occur because the input images were coming from the left Zed camera. This would cause robot to align to the center point of the left camera instead of an image from the center of the robot.</p><p>The robot was also tested on the tape path in the lab that turns in both directions. The robot was able to follow the line well for the shallow turns but ended up turning off the path for the stronger turns. The proportional gain was increased and decreased to see the effect. Increased gain allowed it to react greater when it sensed the turns, but we saw greatly increased oscillation and the robot still was not able to make it around the turn well. The decreased gain got rid of the oscillations but none of the attempts let the robot make it around the turns.<br>
[Caroline]</p><h2 id="trajectory-tracking"><a class="anchor hidden-xs" href="#trajectory-tracking" title="trajectory-tracking"><span class="octicon octicon-link"></span></a>Trajectory Tracking</h2><h3 id="overview2"><a class="anchor hidden-xs" href="#overview2" title="overview2"><span class="octicon octicon-link"></span></a><em>Overview</em></h3><p>We next implemented a Pure Pursuit trajectory tracking algorithm to drive the circle as fast as we could.</p><div class="video-container">
      <iframe width="100%" height="100%" src="https://www.youtube.com/embed/uSGnbyWg3_g" frameborder="0" allowfullscreen></iframe>
    </div><h3 id="camera-calibration"><a class="anchor hidden-xs" href="#camera-calibration" title="camera-calibration"><span class="octicon octicon-link"></span></a><em>Camera Calibration</em></h3><p>In order to properly implement trajectory tracking, we first need to convert from “pixel coordinates” to “world coordinates”. Pixel coordinates refer to pixel indices in the image taken from the onboard camera, we will call <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 2.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em 1002em 2.871em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mo" id="MathJax-Span-3" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-5" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-6" style="font-family: STIXGeneral-Italic; padding-left: 0.207em;">v</span><span class="mo" id="MathJax-Span-7" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">(u,v)</script></span>. We define our world coordinates on a plane along the ground with the origin at the center of the rear axle of the car and to have units of centimeters.</p><p>We first found the camera matrix of the ZED camera, which encodes information about the curvature of the lens. To do this we took about 20 photos of a 10 by 7 checkerboard as picured below.</p><p><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/chess.png" alt=""></p><p>We used OpenCV’s <code>findChessboardCorners</code> function to get the corner points of this checkerboard and the <code>cameraCalibration</code> function to turn this set of corner points into a camera matrix. <sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></p><p><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/chess_highlighted.png" alt=""></p><p>The camera matrix we found was</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>C</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><msub><mi>f</mi><mi>x</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>c</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mi>f</mi><mi>y</mi></msub></mtd><mtd><msub><mi>c</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>351.7</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>306.25</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>353.7</mn></mtd><mtd><mn>183.9</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8" style="width: 24.337em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.931em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-0.202em 1019.73em 4.101em -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-9"><span class="mtable" id="MathJax-Span-10" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 19.623em; height: 0px;"><span style="position: absolute; clip: rect(2.615em 1019.57em 6.919em -999.997em); top: -5.018em; left: 0em;"><span style="display: inline-block; position: relative; width: 19.623em; height: 0px;"><span style="position: absolute; clip: rect(2.615em 1019.57em 6.919em -999.997em); top: -5.018em; right: 0em;"><span class="mtd" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-14" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-15" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-16" style="vertical-align: 2.257em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.305em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.79em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.073em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-17" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 4.408em; height: 0px;"><span style="position: absolute; clip: rect(2.41em 1000.67em 6.457em -999.997em); top: -4.711em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.67em 4.357em -999.997em); top: -5.428em; left: 50%; margin-left: -0.356em;"><span class="mtd" id="MathJax-Span-18"><span class="mrow" id="MathJax-Span-19"><span class="msubsup" id="MathJax-Span-20"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.41em 4.357em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-21" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.259em;"><span class="mi" id="MathJax-Span-22" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -3.993em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-31"><span class="mrow" id="MathJax-Span-32"><span class="mn" id="MathJax-Span-33" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -2.456em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-44"><span class="mrow" id="MathJax-Span-45"><span class="mn" id="MathJax-Span-46" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.716em;"></span></span><span style="position: absolute; clip: rect(2.41em 1000.67em 6.457em -999.997em); top: -4.711em; left: 1.796em;"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -5.428em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mn" id="MathJax-Span-25" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.67em 4.46em -999.997em); top: -3.993em; left: 50%; margin-left: -0.356em;"><span class="mtd" id="MathJax-Span-34"><span class="mrow" id="MathJax-Span-35"><span class="msubsup" id="MathJax-Span-36"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.41em 4.357em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-37" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.259em;"><span class="mi" id="MathJax-Span-38" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -2.456em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-47"><span class="mrow" id="MathJax-Span-48"><span class="mn" id="MathJax-Span-49" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.716em;"></span></span><span style="position: absolute; clip: rect(2.41em 1000.82em 6.15em -999.997em); top: -4.454em; left: 3.589em;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.82em 4.306em -999.997em); top: -5.428em; left: 50%; margin-left: -0.407em;"><span class="mtd" id="MathJax-Span-26"><span class="mrow" id="MathJax-Span-27"><span class="msubsup" id="MathJax-Span-28"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.41em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-29" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-30" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.82em 4.46em -999.997em); top: -3.993em; left: 50%; margin-left: -0.407em;"><span class="mtd" id="MathJax-Span-39"><span class="mrow" id="MathJax-Span-40"><span class="msubsup" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.41em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-42" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-43" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.41em 4.152em -999.997em); top: -2.456em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="mn" id="MathJax-Span-52" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.46em;"></span></span></span></span><span class="mo" id="MathJax-Span-53" style="vertical-align: 2.257em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.305em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.79em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.073em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-54" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-55" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-56" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-57" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 9.48em; height: 0px;"><span style="position: absolute; clip: rect(2.359em 1002.21em 6.304em -999.997em); top: -4.608em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1002.21em 4.152em -999.997em); top: -5.377em; left: 50%; margin-left: -1.124em;"><span class="mtd" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mn" id="MathJax-Span-60" style="font-family: STIXGeneral-Regular;">351.7</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -3.942em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-67"><span class="mrow" id="MathJax-Span-68"><span class="mn" id="MathJax-Span-69" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -2.508em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-76"><span class="mrow" id="MathJax-Span-77"><span class="mn" id="MathJax-Span-78" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.613em;"></span></span><span style="position: absolute; clip: rect(2.359em 1002.21em 6.304em -999.997em); top: -4.608em; left: 3.384em;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -5.377em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-61"><span class="mrow" id="MathJax-Span-62"><span class="mn" id="MathJax-Span-63" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1002.21em 4.152em -999.997em); top: -3.942em; left: 50%; margin-left: -1.124em;"><span class="mtd" id="MathJax-Span-70"><span class="mrow" id="MathJax-Span-71"><span class="mn" id="MathJax-Span-72" style="font-family: STIXGeneral-Regular;">353.7</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -2.508em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-79"><span class="mrow" id="MathJax-Span-80"><span class="mn" id="MathJax-Span-81" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.613em;"></span></span><span style="position: absolute; clip: rect(2.359em 1002.67em 6.253em -999.997em); top: -4.608em; left: 6.765em;"><span style="display: inline-block; position: relative; width: 2.769em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1002.67em 4.152em -999.997em); top: -5.377em; left: 50%; margin-left: -1.381em;"><span class="mtd" id="MathJax-Span-64"><span class="mrow" id="MathJax-Span-65"><span class="mn" id="MathJax-Span-66" style="font-family: STIXGeneral-Regular;">306.25</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1002.21em 4.152em -999.997em); top: -3.942em; left: 50%; margin-left: -1.124em;"><span class="mtd" id="MathJax-Span-73"><span class="mrow" id="MathJax-Span-74"><span class="mn" id="MathJax-Span-75" style="font-family: STIXGeneral-Regular;">183.9</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.41em 4.152em -999.997em); top: -2.508em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-82"><span class="mrow" id="MathJax-Span-83"><span class="mn" id="MathJax-Span-84" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.613em;"></span></span></span></span><span class="mo" id="MathJax-Span-85" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.023em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.023em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.184em; border-left: 0px solid; width: 0px; height: 5.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>C</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>f</mi><mi>x</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>c</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mi>f</mi><mi>y</mi></msub></mtd><mtd><msub><mi>c</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>351.7</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>306.25</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>353.7</mn></mtd><mtd><mn>183.9</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">
\begin{align*}
    C = 
    \begin{bmatrix}
        f_x & 0   & c_x\\
        0   & f_y & c_y\\
        0   & 0   & 1
    \end{bmatrix}
    =
    \begin{bmatrix}
        351.7 & 0 & 306.25\\
        0     & 353.7 & 183.9\\
        0 & 0 & 1
    \end{bmatrix}
\end{align*}
</script></span></p><p>where are the <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mi>x</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-86" style="width: 0.822em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em 1000.67em 2.564em -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-87"><span class="msubsup" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.41em 4.357em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-89" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.259em;"><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-3">f_x</script></span> and <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mi>y</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-91" style="width: 0.822em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em 1000.67em 2.666em -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="msubsup" id="MathJax-Span-93"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.41em 4.357em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-94" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.259em;"><span class="mi" id="MathJax-Span-95" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>y</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">f_y</script></span> are the focal lengths and <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>x</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-96" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em 1000.82em 2.513em -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-97"><span class="msubsup" id="MathJax-Span-98"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.41em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-99" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-100" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">c_x</script></span> and <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>y</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em 1000.82em 2.666em -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="msubsup" id="MathJax-Span-103"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.41em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-104" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-105" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>y</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-6">c_y</script></span> are the optical centers of the camera expressed in pixels for an image of size <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>672</mn><mo>&amp;#x00D7;</mo><mn>367</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-106" style="width: 5.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.152em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em 1004.1em 2.718em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-107"><span class="mn" id="MathJax-Span-108" style="font-family: STIXGeneral-Regular;">672</span><span class="mo" id="MathJax-Span-109" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">×</span><span class="mn" id="MathJax-Span-110" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">367</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>672</mn><mo>×</mo><mn>367</mn></math></span></span><script type="math/tex" id="MathJax-Element-7">672\times 367</script></span> pixels.</p><p>The <code>cameraCalibration</code> function also returned the rotation matrix <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-111" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em 1000.62em 2.718em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-112"><span class="mi" id="MathJax-Span-113" style="font-family: STIXGeneral-Italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">R</script></span> and translation vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>t</mi></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-114" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.796em 1000.36em 2.718em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-115"><span class="texatom" id="MathJax-Span-116"><span class="mrow" id="MathJax-Span-117"><span class="mi" id="MathJax-Span-118" style="font-family: STIXGeneral; font-weight: bold;">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-9">\mathbf{t}</script></span> of each checkerboard relative to the camera. Therefore for affine world coordinates <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>x</mi></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-119" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.949em 1000.51em 2.718em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-120"><span class="texatom" id="MathJax-Span-121"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-10">\mathbf{x}</script></span> the image coordinates were as follows</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>s</mi><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mi>u</mi></mtd></mtr><mtr><mtd><mi>v</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></mtd><mtd><mi></mi><mo>=</mo><mi>C</mi><mrow><mo>[</mo><mrow><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>t</mi></mrow></mrow><mo>]</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>x</mi></mrow></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-124" style="width: 9.07em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.431em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-0.151em 1007.28em 4.05em -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-125"><span class="mtable" id="MathJax-Span-126" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 7.123em; height: 0px;"><span style="position: absolute; clip: rect(2.564em 1002.26em 6.765em -999.997em); top: -4.915em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px;"><span style="position: absolute; clip: rect(2.564em 1002.26em 6.765em -999.997em); top: -4.915em; right: 0em;"><span class="mtd" id="MathJax-Span-127"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-family: STIXGeneral-Italic;">s</span><span class="mrow" id="MathJax-Span-130" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-131" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-132" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(2.359em 1000.46em 5.996em -999.997em); top: -4.352em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.46em 4.152em -999.997em); top: -5.377em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-133"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-family: STIXGeneral-Italic;">u</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.41em 4.152em -999.997em); top: -3.942em; left: 50%; margin-left: -0.202em;"><span class="mtd" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="mi" id="MathJax-Span-138" style="font-family: STIXGeneral-Italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.41em 4.152em -999.997em); top: -2.508em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="mn" id="MathJax-Span-141" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.357em;"></span></span></span></span><span class="mo" id="MathJax-Span-142" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.921em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.921em;"></span></span><span style="position: absolute; clip: rect(3.179em 1004.82em 4.357em -999.997em); top: -3.993em; left: 2.308em;"><span style="display: inline-block; position: relative; width: 4.818em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1004.82em 4.357em -999.997em); top: -3.993em; left: 0em;"><span class="mtd" id="MathJax-Span-143"><span class="mrow" id="MathJax-Span-144"><span class="mi" id="MathJax-Span-145"></span><span class="mo" id="MathJax-Span-146" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-147" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mrow" id="MathJax-Span-148" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-149" style="vertical-align: 0.003em;"><span style="font-family: STIXGeneral-Regular;">[</span></span><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-family: STIXGeneral-Italic;">R</span><span class="texatom" id="MathJax-Span-152"><span class="mrow" id="MathJax-Span-153"><span class="mo" id="MathJax-Span-154" style="font-family: STIXVariants;">|</span></span></span><span class="texatom" id="MathJax-Span-155"><span class="mrow" id="MathJax-Span-156"><span class="mi" id="MathJax-Span-157" style="font-family: STIXGeneral; font-weight: bold;">t</span></span></span></span><span class="mo" id="MathJax-Span-158" style="vertical-align: 0.003em;"><span style="font-family: STIXGeneral-Regular;">]</span></span></span><span class="texatom" id="MathJax-Span-159" style="padding-left: 0.207em;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.122em; border-left: 0px solid; width: 0px; height: 4.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>s</mi><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>u</mi></mtd></mtr><mtr><mtd><mi>v</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></mtd><mtd><mi></mi><mo>=</mo><mi>C</mi><mrow><mo>[</mo><mrow><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi></mrow></mrow><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">
\begin{align*}
    s
    \begin{bmatrix}
        u\\
        v\\
        1
    \end{bmatrix}
    & =
    C\left[R|\mathbf{t}\right]
    \mathbf{x}
\end{align*}
</script></span></p><p>We construct a new matrix <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-162" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em 1000.77em 2.718em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-family: STIXGeneral-Italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">H</script></span> that inverts the rotation and translation transformations done to the checkerboard: <sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>H</mi><mi>C</mi><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>t</mi></mrow><mo stretchy=&quot;false&quot;>]</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>x</mi></mrow><mo>=</mo><mi>C</mi><mo stretchy=&quot;false&quot;>[</mo><mi>I</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>0</mn></mrow><mo stretchy=&quot;false&quot;>]</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>x</mi></mrow></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-165" style="width: 10.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.558em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em 1008.4em 2.615em -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-166"><span class="mtable" id="MathJax-Span-167" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 8.251em; height: 0px;"><span style="position: absolute; clip: rect(3.23em 1008.25em 4.408em -999.997em); top: -3.993em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.251em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1008.25em 4.357em -999.997em); top: -3.942em; right: 0em;"><span class="mtd" id="MathJax-Span-168"><span class="mrow" id="MathJax-Span-169"><span class="mi" id="MathJax-Span-170" style="font-family: STIXGeneral-Italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-171" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-172" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-173" style="font-family: STIXGeneral-Italic;">R</span><span class="texatom" id="MathJax-Span-174"><span class="mrow" id="MathJax-Span-175"><span class="mo" id="MathJax-Span-176" style="font-family: STIXVariants;">|</span></span></span><span class="texatom" id="MathJax-Span-177"><span class="mrow" id="MathJax-Span-178"><span class="mi" id="MathJax-Span-179" style="font-family: STIXGeneral; font-weight: bold;">t</span></span></span><span class="mo" id="MathJax-Span-180" style="font-family: STIXGeneral-Regular;">]</span><span class="texatom" id="MathJax-Span-181"><span class="mrow" id="MathJax-Span-182"><span class="mi" id="MathJax-Span-183" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-184" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-185" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-186" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-187" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="texatom" id="MathJax-Span-188"><span class="mrow" id="MathJax-Span-189"><span class="mo" id="MathJax-Span-190" style="font-family: STIXVariants;">|</span></span></span><span class="texatom" id="MathJax-Span-191"><span class="mrow" id="MathJax-Span-192"><span class="mn" id="MathJax-Span-193" style="font-family: STIXGeneral; font-weight: bold;">0</span></span></span><span class="mo" id="MathJax-Span-194" style="font-family: STIXGeneral-Regular;">]</span><span class="texatom" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>H</mi><mi>C</mi><mo stretchy="false">[</mo><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi></mrow><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>=</mo><mi>C</mi><mo stretchy="false">[</mo><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">0</mn></mrow><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">
\begin{align*}
    HC[R|\mathbf{t}]\mathbf{x} = C[I|\mathbf{0}]\mathbf{x}
\end{align*}
</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo>=</mo><msub><mi>H</mi><mi>R</mi></msub><msub><mi>H</mi><mi>T</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-198" style="width: 5.587em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.562em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em 1004.56em 2.871em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-family: STIXGeneral-Italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-201" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-202" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.77em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-203" style="font-family: STIXGeneral-Italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-205"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.77em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-206" style="font-family: STIXGeneral-Italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-207" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo>=</mo><msub><mi>H</mi><mi>R</mi></msub><msub><mi>H</mi><mi>T</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-14">H = H_RH_T</script></span> is the product of matrices that invert the translation and rotations respectively:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><msub><mi>H</mi><mi>R</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mi>C</mi><msup><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><msup><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>q</mi></mrow></mtd><mtd><mi></mi><mo>=</mo><msup><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>t</mi></mrow></mtd></mtr><mtr><mtd><msub><mi>H</mi><mi>T</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mtd><mtd /></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mtd><mtd><mo>&amp;#x2212;</mo><mfrac><mrow><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>q</mi></mrow></mrow><msub><mi>q</mi><mi>z</mi></msub></mfrac></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mtd><mtd /></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-208" style="width: 13.066em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.71em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-1.893em 1010.5em 5.791em -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-209"><span class="mtable" id="MathJax-Span-210" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 10.402em; height: 0px;"><span style="position: absolute; clip: rect(2.41em 1001.23em 7.994em -999.997em); top: -6.247em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1001.23em 4.306em -999.997em); top: -7.016em; right: 0em;"><span class="mtd" id="MathJax-Span-211"><span class="mrow" id="MathJax-Span-212"><span class="msubsup" id="MathJax-Span-213"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.77em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-214" style="font-family: STIXGeneral-Italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-215" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.51em 4.357em -999.997em); top: -5.581em; right: 0em;"><span class="mtd" id="MathJax-Span-233"><span class="mrow" id="MathJax-Span-234"><span class="texatom" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="mi" id="MathJax-Span-237" style="font-family: STIXGeneral; font-weight: bold;">q</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1001.23em 4.306em -999.997em); top: -2.559em; right: 0em;"><span class="mtd" id="MathJax-Span-251"><span class="mrow" id="MathJax-Span-252"><span class="msubsup" id="MathJax-Span-253"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.77em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-254" style="font-family: STIXGeneral-Italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.253em;"></span></span><span style="position: absolute; clip: rect(4.255em 1009.07em 11.939em -999.997em); top: -8.348em; left: 1.232em;"><span style="display: inline-block; position: relative; width: 9.121em; height: 0px;"><span style="position: absolute; clip: rect(2.974em 1005.18em 4.152em -999.997em); top: -7.016em; left: 0em;"><span class="mtd" id="MathJax-Span-216"><span class="mrow" id="MathJax-Span-217"><span class="mi" id="MathJax-Span-218"></span><span class="mo" id="MathJax-Span-219" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-220" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-221"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.57em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-222" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.617em;"><span class="texatom" id="MathJax-Span-223"><span class="mrow" id="MathJax-Span-224"><span class="mo" id="MathJax-Span-225" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-226" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-227"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.67em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-228" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.771em;"><span class="texatom" id="MathJax-Span-229"><span class="mrow" id="MathJax-Span-230"><span class="mo" id="MathJax-Span-231" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-232" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em 1003.18em 4.152em -999.997em); top: -5.581em; left: 0em;"><span class="mtd" id="MathJax-Span-238"><span class="mrow" id="MathJax-Span-239"><span class="mi" id="MathJax-Span-240"></span><span class="mo" id="MathJax-Span-241" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-242" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.57em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-243" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.617em;"><span class="texatom" id="MathJax-Span-244"><span class="mrow" id="MathJax-Span-245"><span class="mo" id="MathJax-Span-246" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-247" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-family: STIXGeneral; font-weight: bold;">t</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.82em 1009.07em 7.636em -999.997em); top: -4.045em; left: 0em;"><span class="mtd" id="MathJax-Span-256"><span class="mrow" id="MathJax-Span-257"><span class="mi" id="MathJax-Span-258"></span><span class="mo" id="MathJax-Span-259" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-260" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-261" style="vertical-align: 2.513em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.156em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.456em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.586em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.715em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-262" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 6.611em; height: 0px;"><span style="position: absolute; clip: rect(2.666em 1000.46em 7.123em -999.997em); top: -5.172em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.41em 4.152em -999.997em); top: -5.684em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-263"><span class="mrow" id="MathJax-Span-264"><span class="mn" id="MathJax-Span-265" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -3.993em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-276"><span class="mrow" id="MathJax-Span-277"><span class="mn" id="MathJax-Span-278" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -2.2em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-299"><span class="mrow" id="MathJax-Span-300"><span class="mn" id="MathJax-Span-301" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.177em;"></span></span><span style="position: absolute; clip: rect(2.666em 1000.46em 7.123em -999.997em); top: -5.172em; left: 1.642em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -5.684em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-266"><span class="mrow" id="MathJax-Span-267"><span class="mn" id="MathJax-Span-268" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.41em 4.152em -999.997em); top: -3.993em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-279"><span class="mrow" id="MathJax-Span-280"><span class="mn" id="MathJax-Span-281" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.46em 4.152em -999.997em); top: -2.2em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-302"><span class="mrow" id="MathJax-Span-303"><span class="mn" id="MathJax-Span-304" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.177em;"></span></span><span style="position: absolute; clip: rect(2.871em 1000.21em 7.533em -999.997em); top: -5.377em; left: 3.23em;"><span style="display: inline-block; position: relative; width: 0.31em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.21em 4.357em -999.997em); top: -5.684em; left: 50%; margin-left: -0.151em;"><span class="mtd" id="MathJax-Span-269"><span class="mrow" id="MathJax-Span-270"><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="mo" id="MathJax-Span-273" style="font-family: STIXVariants;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.21em 4.357em -999.997em); top: -3.993em; left: 50%; margin-left: -0.151em;"><span class="mtd" id="MathJax-Span-282"><span class="mrow" id="MathJax-Span-283"><span class="texatom" id="MathJax-Span-284"><span class="mrow" id="MathJax-Span-285"><span class="mo" id="MathJax-Span-286" style="font-family: STIXVariants;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.21em 4.357em -999.997em); top: -2.2em; left: 50%; margin-left: -0.151em;"><span class="mtd" id="MathJax-Span-305"><span class="mrow" id="MathJax-Span-306"><span class="texatom" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="mo" id="MathJax-Span-309" style="font-family: STIXVariants;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.382em;"></span></span><span style="position: absolute; clip: rect(2.615em 1001.95em 6.406em -999.997em); top: -4.454em; left: 4.716em;"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px;"><span style="position: absolute; clip: rect(3.845em 1000em 4.152em -999.997em); top: -5.684em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-274"><span class="mrow" id="MathJax-Span-275"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.82em 1001.95em 4.716em -999.997em); top: -3.993em; left: 50%; margin-left: -0.971em;"><span class="mtd" id="MathJax-Span-287"><span class="mrow" id="MathJax-Span-288"><span class="mo" id="MathJax-Span-289" style="font-family: STIXGeneral-Regular;">−</span><span class="mfrac" id="MathJax-Span-290"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.384em 1000.87em 4.306em -999.997em); top: -4.557em; left: 50%; margin-left: -0.459em;"><span class="mrow" id="MathJax-Span-291"><span class="mi" id="MathJax-Span-292" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-293"><span class="mrow" id="MathJax-Span-294"><span class="mi" id="MathJax-Span-295" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">q</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.537em 1000.62em 4.357em -999.997em); top: -3.635em; left: 50%; margin-left: -0.305em;"><span class="msubsup" id="MathJax-Span-296"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.537em 1000.36em 4.306em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-297" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.361em;"><span class="mi" id="MathJax-Span-298" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em 1001.03em 1.232em -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.027em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em 1000em 4.152em -999.997em); top: -2.2em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-310"><span class="mrow" id="MathJax-Span-311"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.46em;"></span></span></span></span><span class="mo" id="MathJax-Span-312" style="vertical-align: 2.513em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.156em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.456em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.586em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.715em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.484em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.353em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.247em; border-left: 0px solid; width: 0px; height: 9.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>H</mi><mi>R</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mi>C</mi><msup><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">q</mi></mrow></mtd><mtd><mi></mi><mo>=</mo><msup><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi></mrow></mtd></mtr><mtr><mtd><msub><mi>H</mi><mi>T</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd><mo>−</mo><mfrac><mrow><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">q</mi></mrow></mrow><msub><mi>q</mi><mi>z</mi></msub></mfrac></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mtd><mtd></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">
\begin{align*}
    H_R
    & =
    CR^{-1}C^{-1}
    \\
    \mathbf{q} &= R^{-1}\mathbf{t}\\
    H_T
    & =
    \begin{bmatrix}
        1 & 0 & | &\\
        0 & 1 & | & -\frac{C\mathbf{q}}{q_z}\\
        0 & 0 & | &
    \end{bmatrix}
    \\
\end{align*}
</script></span></p><p>This transformation matrix puts the origin at the top left corner of the chess board. To center it at the very center of the chess board we subtracted half of the width of the chessboard from the translation components of <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>H</mi><mi>T</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-313" style="width: 1.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em 1001.23em 2.513em -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-314"><span class="msubsup" id="MathJax-Span-315"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.77em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-316" style="font-family: STIXGeneral-Italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-317" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>H</mi><mi>T</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-16">H_T</script></span>. We also scaled the image to centimeters by setting the scale factor (the bottom right hand coordinte) of <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>H</mi><mi>T</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-318" style="width: 1.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em 1001.23em 2.513em -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-319"><span class="msubsup" id="MathJax-Span-320"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.77em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-321" style="font-family: STIXGeneral-Italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-322" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>H</mi><mi>T</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-17">H_T</script></span> to be <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><msub><mi>q</mi><mi>z</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-323" style="width: 2.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em 1001.64em 2.923em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-324"><span class="mn" id="MathJax-Span-325" style="font-family: STIXGeneral-Regular;">1</span><span class="texatom" id="MathJax-Span-326"><span class="mrow" id="MathJax-Span-327"><span class="mo" id="MathJax-Span-328" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="msubsup" id="MathJax-Span-329"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.46em 4.357em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-330" style="font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-331" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msub><mi>q</mi><mi>z</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-18">1/q_z</script></span> rather than 1. The following image for demonstration purposes centers the chessboard in the image (not at the origin) and scales to fit in the image (not to centimeters).</p><p><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/chess_transformed.png" alt=""></p><p>We used the following image to define the rotation and translation of the floor. The resulting transformation matrix is then stored as a constant in our code. After performing this transformation we add the distance from the center of this chessboard to the rear axel to the forward direction. The mage is overlayed with a square grid of width <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2.45</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-332" style="width: 2.154em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.744em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em 1001.69em 2.718em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-333"><span class="mn" id="MathJax-Span-334" style="font-family: STIXGeneral-Regular;">2.45</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2.45</mn></math></span></span><script type="math/tex" id="MathJax-Element-19">2.45</script></span> cm (the width of a single chess square) produced by our transformation matrix.</p><p><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/grid_overlay.png" alt=""></p><p>The camera matrix could successfully determine distances on the floor within a centimeter in a range of at least 2 meters in front of it.</p><p>These transformations are included in <code>CoordinateTransformations.py</code> in the Appendix.</p><p>[Trevor]</p><h3 id="pure-pursuit"><a class="anchor hidden-xs" href="#pure-pursuit" title="pure-pursuit"><span class="octicon octicon-link"></span></a><em>Pure Pursuit</em></h3><p>The goal of Pure Pursuit is to find a goal point in real world coordinates at some set “lookahead” distance and use the Ackermann Steering model of the car to drive to that point at constant steering angle and velocity. The goal point is defined as the intersection between the line and a circle with radius equal to the lookahead distance centered at the rear axle.</p><p>To achieve this, we first apply the same thresholding filter we used in cone detection to mask the tape from the background. As seen below, the same thresholds give good results (and even detect the cone on the table in the background) and return on the order of 10,000 points in the mask.</p><p>The robot needs to find a point on the tape that is at the lookahead distance from the rear axle. To find the goal point in the image, we first convert coordinates in the mask into real world coordinates using the camera transformation matrix described above. This computation is expensive, however, and when run on all approximately 10,000 points in the mask creates a bottleneck in the system. To reduce the number of points that must be processed with the transformation matrix, we find the bounding contour of the mask using OpenCV’s <code>findContours</code> method. This returns points along one side of the tape mask as shown below. To further reduce processing, our implementation only applies the camera transformation to 50 randomly sampled points along the contour. This gives 50 points along the tape and their respective transverse and longitudinal distances from the center of the rear axle.</p><p>The goal point is determined by finding the point among the randomly sampled points whose Euclidean norm is closest to the lookahead distance set in the Pure Pursuit algorithm. This is found by an iterative search. For the sake of demonstration, we apply the inverse of the transformation matrix to the goal point to map the goal point back to pixel coordinates and plot the goal point’s pixel coordinates on the original image with a blue circle. As shown below, the algorithm chooses a point on the tape at a set distance from the rear axle of the car.</p><table>
<thead>
<tr>
<th style="text-align:center"><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/angle1.png" alt=""> <strong>Original image</strong></th>
<th style="text-align:center"><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/mask.png" alt=""> <strong>Threshold mask</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/contour.png" alt=""> <strong>Contour of mask</strong></td>
<td style="text-align:center"><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/goal.png" alt=""> <strong>Chosen goal</strong></td>
</tr>
</tbody>
</table><p>So far, our algorithm has produced a goal point for the car to drive towards given as a forward and horizontal distance in centimeters from the rear axle. With this goal point (shown as <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>g</mi><mi>x</mi></msub><mo>,</mo><msub><mi>g</mi><mi>y</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-163" style="width: 3.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.871em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em 1002.82em 3.025em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-164"><span class="mo" id="MathJax-Span-165" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-166"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.46em 4.357em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-167" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-168" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-169" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-170" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.46em 4.357em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-171" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-173" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>g</mi><mi>x</mi></msub><mo>,</mo><msub><mi>g</mi><mi>y</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">(g_x, g_y)</script></span> below), we set the steering angle of the car by the simplified bicycle Ackermann model. [2]</p><p><img src="https://github.mit.edu/pages/rss2017-team8/images/lab4/ackermann.png" alt=""></p><p>With these definitions and wheelbase <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo>=</mo><mn>32.5</mn><mi>c</mi><mi>m</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-174" style="width: 5.843em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.767em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em 1004.77em 2.718em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-175"><span class="mi" id="MathJax-Span-176" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-177" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-178" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">32.5</span><span class="mi" id="MathJax-Span-179" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-180" style="font-family: STIXGeneral-Italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>=</mo><mn>32.5</mn><mi>c</mi><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">L = 32.5cm</script></span>, we can find steering angle <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B4;</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-181" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em 1000.46em 2.718em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-182"><span class="mi" id="MathJax-Span-183" style="font-family: STIXGeneral-Italic;">δ</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>δ</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">\delta</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd /><mtd><msub><mi>l</mi><mi>d</mi></msub><mo>=</mo><msqrt><msubsup><mi>g</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>g</mi><mi>y</mi><mn>2</mn></msubsup></msqrt></mtd></mtr><mtr><mtd /><mtd><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><msub><mi>l</mi><mi>d</mi></msub><msub><mi>g</mi><mi>x</mi></msub></mfrac></mtd></mtr><mtr><mtd /><mtd><mi>&amp;#x03B4;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>arctan</mi><mo>&amp;#x2061;</mo><mrow><mo>(</mo><mfrac><mrow><mn>2</mn><mi>L</mi><mi>sin</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow><msub><mi>l</mi><mi>d</mi></msub></mfrac><mo>)</mo></mrow></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-184" style="width: 14.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.785em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-1.688em 1011.48em 5.587em -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-185"><span class="mtable" id="MathJax-Span-186" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 11.478em; height: 0px;"><span style="position: absolute; clip: rect(3.281em 1000em 8.558em -999.997em); top: -5.991em; left: 0em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.845em 1000em 4.152em -999.997em); top: -6.555em; right: 0em;"><span class="mtd" id="MathJax-Span-187"><span class="mrow" id="MathJax-Span-188"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em 1000em 4.152em -999.997em); top: -4.198em; right: 0em;"><span class="mtd" id="MathJax-Span-206"><span class="mrow" id="MathJax-Span-207"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em 1000em 4.152em -999.997em); top: -1.586em; right: 0em;"><span class="mtd" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.996em;"></span></span><span style="position: absolute; clip: rect(4.101em 1011.32em 11.376em -999.997em); top: -7.989em; left: 0em;"><span style="display: inline-block; position: relative; width: 11.478em; height: 0px;"><span style="position: absolute; clip: rect(2.666em 1006.15em 4.818em -999.997em); top: -6.555em; left: 0em;"><span class="mtd" id="MathJax-Span-189"><span class="mrow" id="MathJax-Span-190"><span class="msubsup" id="MathJax-Span-191"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.26em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-192" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.259em;"><span class="mi" id="MathJax-Span-193" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-194" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msqrt" id="MathJax-Span-195" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 4.152em; height: 0px;"><span style="position: absolute; clip: rect(3.025em 1003.08em 4.46em -999.997em); top: -3.993em; left: 1.078em;"><span class="mrow" id="MathJax-Span-196"><span class="msubsup" id="MathJax-Span-197"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.46em 4.357em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-198" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.41em 4.152em -999.997em); top: -4.352em; left: 0.515em;"><span class="mn" id="MathJax-Span-199" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.537em 1000.41em 4.152em -999.997em); top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-200" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-201" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="msubsup" id="MathJax-Span-202" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.46em 4.357em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-203" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.41em 4.152em -999.997em); top: -4.352em; left: 0.515em;"><span class="mn" id="MathJax-Span-204" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.537em 1000.41em 4.306em -999.997em); top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-205" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.025em 1003.08em 3.384em -999.997em); top: -4.301em; left: 1.078em;"><span style="display: inline-block; position: relative; width: 3.076em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.993em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.993em; left: 2.564em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.993em; left: 0.412em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.993em; left: 0.822em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.993em; left: 1.283em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.993em; left: 1.693em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.993em; left: 2.154em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.308em 1001.08em 4.46em -999.997em); top: -3.584em; left: 0em;"><span style="font-family: STIXSizeOneSym;">√</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.462em 1005.89em 5.023em -999.997em); top: -4.198em; left: 0em;"><span class="mtd" id="MathJax-Span-208"><span class="mrow" id="MathJax-Span-209"><span class="mi" id="MathJax-Span-210" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-211" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-212" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-213" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-214" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-215" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-216" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-217" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-218" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-219" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mfrac" id="MathJax-Span-220" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em 1000.72em 4.306em -999.997em); top: -4.659em; left: 50%; margin-left: -0.356em;"><span class="msubsup" id="MathJax-Span-221"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.26em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-222" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.259em;"><span class="mi" id="MathJax-Span-223" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em 1000.87em 4.357em -999.997em); top: -3.327em; left: 50%; margin-left: -0.459em;"><span class="msubsup" id="MathJax-Span-224"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em 1000.46em 4.357em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-225" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-226" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em 1001.03em 1.232em -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.027em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.462em 1011.32em 4.972em -999.997em); top: -1.586em; left: 0em;"><span class="mtd" id="MathJax-Span-229"><span class="mrow" id="MathJax-Span-230"><span class="mi" id="MathJax-Span-231" style="font-family: STIXGeneral-Italic;">δ</span><span class="mo" id="MathJax-Span-232" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-233" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-234" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-235" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-236" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">arctan</span><span class="mo" id="MathJax-Span-237"></span><span class="mrow" id="MathJax-Span-238"><span class="mo" id="MathJax-Span-239" style="vertical-align: -0.459em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">(</span></span></span><span class="mfrac" id="MathJax-Span-240"><span style="display: inline-block; position: relative; width: 4.716em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em 1004.56em 4.306em -999.997em); top: -4.659em; left: 50%; margin-left: -2.303em;"><span class="mrow" id="MathJax-Span-241"><span class="mn" id="MathJax-Span-242" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-243" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-244" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">sin</span><span class="mo" id="MathJax-Span-245"></span><span class="mo" id="MathJax-Span-246" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-247" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-248" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-249" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-250" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-251" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em 1000.72em 4.306em -999.997em); top: -3.327em; left: 50%; margin-left: -0.356em;"><span class="msubsup" id="MathJax-Span-252"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.179em 1000.26em 4.152em -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-253" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.259em;"><span class="mi" id="MathJax-Span-254" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em 1004.72em 1.232em -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.716em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-255" style="vertical-align: -0.459em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.994em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.997em; border-left: 0px solid; width: 0px; height: 8.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd></mtd><mtd><msub><mi>l</mi><mi>d</mi></msub><mo>=</mo><msqrt><msubsup><mi>g</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>g</mi><mi>y</mi><mn>2</mn></msubsup></msqrt></mtd></mtr><mtr><mtd></mtd><mtd><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mfrac><msub><mi>l</mi><mi>d</mi></msub><msub><mi>g</mi><mi>x</mi></msub></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi>δ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>arctan</mi><mo>⁡</mo><mrow><mo>(</mo><mfrac><mrow><mn>2</mn><mi>L</mi><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><msub><mi>l</mi><mi>d</mi></msub></mfrac><mo>)</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">
\begin{align*}
    &l_d = \sqrt{g_x^2 + g_y^2}\\
    &sin(\alpha(t)) = \frac{l_d}{g_x}\\
    &\delta(t) =
    \arctan\left(
        \frac{2L\sin(\alpha(t))}{l_d}
    \right)
\end{align*}
</script></span></p><p>We command steering angle <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B4;</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-256" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em 1000.46em 2.718em -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-257"><span class="mi" id="MathJax-Span-258" style="font-family: STIXGeneral-Italic;">δ</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>δ</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">\delta</script></span> and drive at a constant velocity of our choosing. The lookahead distance and the speed of the car should be adjusted together- the faster the car is going, the further the goal point should be down the path. We thus set the quotient of the lookahead distance and the velocity of the car with a constant <code>reactionTime</code>. Through experimentation, we found that setting the car’s velocity to 2.5 meters per second and its <code>reactionTime</code> to 0.4 seconds gave the best stability while driving around the circle track. The Pure Pursuit control code is provided in the Appendix in <code>PurePursuit.py</code>.</p><p>[Kevin]</p><h2 id="line-follower-results"><a class="anchor hidden-xs" href="#line-follower-results" title="line-follower-results"><span class="octicon octicon-link"></span></a>Line Follower Results</h2><p>Quantitative Line-following Performance<br>
In testing, we tried to assess the following:</p><ol>
<li>How many times can the car drive around the circle without colliding with the inner obstacle or desks around the circle?</li>
<li>What’s the fastest speed it can go without collisions?</li>
</ol><p>With open loop control, the car could not complete a single lap without colliding with obstacles around the circle. When we introduced feedback control with the setpoint controller and Pure Pursuit controller, the system was much more stable. As long as the set speed was not too high, both systems could drive around the circle indefinitely.</p><table>
<thead>
<tr>
<th>Method</th>
<th># of Circles Completed</th>
<th>Maximum Stable Speed</th>
</tr>
</thead>
<tbody>
<tr>
<td>Open-Loop</td>
<td>0.25</td>
<td>0.4 m/s</td>
</tr>
<tr>
<td>Setpoint</td>
<td>5 [turned off]</td>
<td>0.46 m/s</td>
</tr>
<tr>
<td>Pure Pursuit</td>
<td>5 [turned off]</td>
<td>2.23 m/s</td>
</tr>
</tbody>
</table><p>The pure pursuit controller went fastest at 2.23 m/s as opposed to the setpoint controller which only went 0.466 m/s. The pure pursuit controller is able to go much faster because it looks much farther ahead of the curve than the setpoint controller.<br>
[Katy, Kevin]</p><h1 id="teamwork"><a class="anchor hidden-xs" href="#teamwork" title="teamwork"><span class="octicon octicon-link"></span></a>Teamwork</h1><p>Both portions of the lab allowed for division of responsibilities and practice in collaboration throughout the technical work. In lab 4A, the function of the controllers was essentially the same so the division first came from splitting off to attempt different cone detection implementations. This part of the lab definitely became an important practice for the team because it would require ability of teams to evaluate which cone detector worked best without bias of having worked on a different implementation. It helped that going into the process we all identified that this consolidation process would be required, and even expected a certain one to have the best performance. The choice was also easier because over the past few labs the team has been able to come together to work with everyone wanting the robot to operate with the best possible functionality, and using a technical filter to avoid any personal bias.</p><p>Part 4B of the lab had three defined methods of line-following to implement and compare to each other, so the team was able to divide and conquer each the open-loop, setpoint, and pure pursuit controllers. One person each worked on the first two because they were simpler to execute, and everyone else collaborated to execute the pure pursuit method. There was more collaboration during the debugging process and in running the robot through the required experiments.<br>
[Caroline]</p><h1 id="conclusion"><a class="anchor hidden-xs" href="#conclusion" title="conclusion"><span class="octicon octicon-link"></span></a>Conclusion</h1><p>Overall, each aspect of the lab was successful. For part 4A, in terms of ability to complete the task, we were able to successfully maintain a set distance from the cone, and park in front of it. The robot was generally responsive, and could follow the cone both forwards and backwards. Even from a relatively large distance &gt; 8ft, and at an angle, the car was able to locate and park in front of the cone. In part 4B, all line following methods were implemented successfully so as to evaluate the relative performances. It was determined through qualitative and quantitative experimentation that the Pure Pursuit implementation was the most responsive and controllable method for line following, even at high speeds.</p><p>An additional important take-away from this lab project was the camera calibration process, which can be utilized again in the future. Though it took a lot of time, we have a very accurate distance estimation capability.</p><p>The team website has continued to be updated. The most recent updates were to upload project images to the gallery pages, continue to update asthetics, and to add information about the class and projects.</p><p>[Josh, Caroline]</p><h1 id="appendix"><a class="anchor hidden-xs" href="#appendix" title="appendix"><span class="octicon octicon-link"></span></a>Appendix</h1><p>Full code available upon request.</p><h2 id="pure-pursuit-code-snippets"><a class="anchor hidden-xs" href="#pure-pursuit-code-snippets" title="pure-pursuit-code-snippets"><span class="octicon octicon-link"></span></a>Pure Pursuit Code Snippets</h2><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span></div><div class="code"><span class="hljs-comment">#CameraSettings.py</span>

<span class="hljs-comment">#Stores constants for camera transformation matrix and car dimensions </span>
<span class="hljs-comment">#found in offline processing</span>

<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

TRANSFORMATION_MATRIX = np.array(
  [[  <span class="hljs-number">9.97483827e-01</span>,  <span class="hljs-number">-2.81893211e-01</span>,  <span class="hljs-number">-2.64944973e+02</span>],
   [  <span class="hljs-number">1.95516554e-02</span>,   <span class="hljs-number">2.16788505e+00</span>,  <span class="hljs-number">-6.71284167e+02</span>],
   [  <span class="hljs-number">5.15496517e-04</span>,   <span class="hljs-number">5.68335936e-02</span>,  <span class="hljs-number">-8.26420446e+00</span>]])

DISTANCE_FROM_BACK_WHEEL= <span class="hljs-number">53.3</span>+<span class="hljs-number">9.6</span> <span class="hljs-comment">#cm</span>
DISTANCE_FROM_CENTER = <span class="hljs-number">-1.3</span> <span class="hljs-comment">#cm</span>

</div></div></code></pre><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span></div><div class="code"><span class="hljs-comment">#CoordinateTransformations.py</span>

<span class="hljs-comment">#Applies transformations to pixel values to obtain world coordinates </span>
<span class="hljs-comment">#given camera transformation matrix</span>

<span class="hljs-comment">#...</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CoordinateTransformations</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, transformationMatrix, distanceToBackWheel, distanceToCenter)</span>:</span>
        self.transformationMatrix = transformationMatrix
        self.inverseTransformationMatrix = np.linalg.inv(transformationMatrix)
        <span class="hljs-comment"># in CM</span>
        self.distanceToBackWheel = distanceToBackWheel
        self.distanceToCenter = distanceToCenter

    <span class="hljs-comment"># (0,0) is the back wheel</span>
    <span class="hljs-comment"># measurement is in CM</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">transformPixelsToWorld</span><span class="hljs-params">(self, pixelCoordinates)</span>:</span>
        affinePixelCoordinates = [pixelCoordinates[<span class="hljs-number">0</span>], pixelCoordinates[<span class="hljs-number">1</span>], <span class="hljs-number">1</span>]
        affineWorldCoordinates = np.matmul(self.transformationMatrix, affinePixelCoordinates)

        worldCoordinates = [affineWorldCoordinates[<span class="hljs-number">0</span>]/affineWorldCoordinates[<span class="hljs-number">2</span>], affineWorldCoordinates[<span class="hljs-number">1</span>]/affineWorldCoordinates[<span class="hljs-number">2</span>]]
        worldCoordinates[<span class="hljs-number">0</span>] = worldCoordinates[<span class="hljs-number">0</span>] + self.distanceToCenter
        worldCoordinates[<span class="hljs-number">1</span>] = -worldCoordinates[<span class="hljs-number">1</span>] + self.distanceToBackWheel

        <span class="hljs-comment"># returns measurement in cm</span>
        <span class="hljs-keyword">return</span> worldCoordinates

    <span class="hljs-comment"># ...</span>
</div></div></code></pre><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span>
<span data-linenumber="43"></span>
<span data-linenumber="44"></span>
<span data-linenumber="45"></span>
<span data-linenumber="46"></span>
<span data-linenumber="47"></span>
<span data-linenumber="48"></span>
<span data-linenumber="49"></span>
<span data-linenumber="50"></span>
<span data-linenumber="51"></span></div><div class="code"><span class="hljs-comment"># CircleThreshold.py</span>

<span class="hljs-comment"># Thresholds image and finds goal point in contour of threshold mask</span>
<span class="hljs-comment"># PurePursuit.py makes call to findGoalPoint()</span>

<span class="hljs-keyword">from</span> CoordinateTransformations <span class="hljs-keyword">import</span> CoordinateTransformations
<span class="hljs-keyword">from</span> CameraSettings <span class="hljs-keyword">import</span> *
<span class="hljs-comment"># ...</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CircleThreshold</span>:</span>
    RANDOM_SAMPLE_SIZE = <span class="hljs-number">50</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, lookAheadDistance)</span>:</span>
        self.lookAheadDistance = lookAheadDistance
        <span class="hljs-comment">#lookahead distance in cm</span>
        self.mask = <span class="hljs-keyword">None</span>

        self.CoordinateTransformations = CoordinateTransformations(\
            TRANSFORMATION_MATRIX, DISTANCE_FROM_BACK_WHEEL, \
            DISTANCE_FROM_CENTER)
    
    <span class="hljs-comment">#applies cv2.inrange filter to image, stores mask in self.mask</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">threshold</span><span class="hljs-params">(self, inputImage)</span>:</span>
        <span class="hljs-comment"># ...</span>

    <span class="hljs-comment">#applies transformation to points on contour and saves real</span>
    <span class="hljs-comment">#world coordinates to self.circle    </span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">transform</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-comment">#...</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findBestContour</span><span class="hljs-params">(self)</span>:</span>
        _, contours, _ = cv2.findContours(\
                self.mask, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_NONE)
        self.contourPoints = [point <span class="hljs-keyword">for</span> contour <span class="hljs-keyword">in</span> contours\
                                <span class="hljs-keyword">for</span> point <span class="hljs-keyword">in</span> contour]

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findGoalPoint</span><span class="hljs-params">(self, inputImage)</span>:</span>
        self.threshold(inputImage)
        self.findBestContour()
        self.transform()
        
        closest = <span class="hljs-keyword">None</span>
        <span class="hljs-keyword">for</span> (x, y) <span class="hljs-keyword">in</span> self.circle:
            <span class="hljs-keyword">if</span> closest: 
                <span class="hljs-keyword">if</span> abs(np.linalg.norm((x, y))-self.lookAheadDistance) &lt; \   
                    abs(np.linalg.norm(closest)-self.lookAheadDistance):
                    closest = (x, y)
            <span class="hljs-keyword">else</span>:
                closest = (x, y)
        
        <span class="hljs-keyword">return</span> closest
</div></div></code></pre><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span>
<span data-linenumber="43"></span>
<span data-linenumber="44"></span>
<span data-linenumber="45"></span>
<span data-linenumber="46"></span>
<span data-linenumber="47"></span>
<span data-linenumber="48"></span>
<span data-linenumber="49"></span>
<span data-linenumber="50"></span>
<span data-linenumber="51"></span>
<span data-linenumber="52"></span>
<span data-linenumber="53"></span></div><div class="code"><span class="hljs-comment">#!/usr/bin/env python</span>

<span class="hljs-comment"># PurePursuit.py</span>

<span class="hljs-comment"># Calls on CircleThreshold.py to find goal point and then uses</span>
<span class="hljs-comment"># Ackerman model of RACECAR to steer at constant angle to goal.</span>

<span class="hljs-keyword">from</span> CircleThreshold <span class="hljs-keyword">import</span> CircleThreshold
<span class="hljs-comment"># ...</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PurePursuit</span>:</span>
    carLength = <span class="hljs-number">32.5</span> <span class="hljs-comment"># cm</span>
    velocity = <span class="hljs-number">2.5</span> <span class="hljs-comment"># m/s</span>
    reactionTime = <span class="hljs-number">0.4</span>  <span class="hljs-comment"># sec</span>
    lookAheadDistance = velocity * <span class="hljs-number">100</span> * reactionTime

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self)</span>:</span>
        self.bridge = CvBridge()
        self.sub_image = rospy.Subscriber(<span class="hljs-string">"/zed/rgb/image_rect_color"</span>,\
                Image, self.PureControl, queue_size=<span class="hljs-number">1</span>)

        self.publisher = rospy.Publisher(\
                <span class="hljs-string">"/vesc/high_level/ackermann_cmd_mux/input/nav_0"</span>,\
                AckermannDriveStamped,\
                queue_size = <span class="hljs-number">1</span>)

        self.pub_image = rospy.Publisher(<span class="hljs-string">"/echo_image"</span>,\
                Image, queue_size=<span class="hljs-number">1</span>)
    
    <span class="hljs-comment"># Handler for image messages from camera</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">PureControl</span><span class="hljs-params">(self, image_msg)</span>:</span>
        image_cv = self.bridge.imgmsg_to_cv2(image_msg)            

        ct = CircleThreshold(self.lookAheadDistance)
        goalPointWorld = ct.findGoalPoint(image_cv)

        steeringAngle = self.ackermannAngle(goalPointWorld)
        msg = AckermannDriveStamped()
        <span class="hljs-keyword">if</span> steeringAngle:
            rospy.loginfo(<span class="hljs-string">'steeringAngle = %f'</span>, steeringAngle)
            msg.drive.speed = self.velocity
            msg.drive.steering_angle = steeringAngle
        <span class="hljs-keyword">else</span>:
            rospy.loginfo(<span class="hljs-string">"no line!"</span>)

        self.publisher.publish(msg)

    <span class="hljs-comment"># Return steering angle to goalPoint given by simplified</span>
    <span class="hljs-comment"># Ackermann model of car.</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ackermannAngle</span><span class="hljs-params">(self, goalPointWorld)</span>:</span>
        <span class="hljs-comment"># ...</span>

<span class="hljs-comment"># ...</span>
</div></div></code></pre><h2 id="sources"><a class="anchor hidden-xs" href="#sources" title="sources"><span class="octicon octicon-link"></span></a>Sources</h2><p>[1] <a href="http://aishack.in/tutorials/sift-scale-invariant-feature-transform-introduction/" target="_blank">http://aishack.in/tutorials/sift-scale-invariant-feature-transform-introduction/</a><br>
[2]<a href="https://www.ri.cmu.edu/pub_files/2009/2/Automatic_Steering_Methods_for_Autonomous_Automobile_Path_Tracking.pdf" target="_blank">https://www.ri.cmu.edu/pub_files/2009/2/Automatic_Steering_Methods_for_Autonomous_Automobile_Path_Tracking.pdf</a></p></div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>

          </div>
        </div> 
      </div> <!-- End Container -->
    </main>    

    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="materialize/js/materialize.min.js"></script>
    <script type="text/javascript" src="scripts/team8.js"></script>
  </body>
</html>